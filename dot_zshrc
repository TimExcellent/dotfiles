#!/bin/zsh
# ============================================================================
# Pure ZSH Configuration - No Oh My Zsh Bloat
# ============================================================================

# === ENVIRONMENT ===

# Clear and explicit PATH setup
export PATH="$HOME/.local/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"

# Editor settings
export EDITOR="nvim"
export VISUAL="nvim"

# Language settings
export LANG="en_US.UTF-8"
export LC_ALL="en_US.UTF-8"

# === SHELL OPTIONS ===

# History configuration - extensive and shared
HISTFILE="$HOME/.zsh_history"
HISTSIZE=10000
SAVEHIST=10000
setopt EXTENDED_HISTORY          # Save timestamp and duration
setopt SHARE_HISTORY             # Share history between sessions
setopt HIST_EXPIRE_DUPS_FIRST    # Expire duplicates first
setopt HIST_IGNORE_DUPS          # Don't save duplicates
setopt HIST_IGNORE_ALL_DUPS      # Remove old duplicates
setopt HIST_FIND_NO_DUPS         # Don't show duplicates in search
setopt HIST_IGNORE_SPACE         # Ignore commands starting with space
setopt HIST_SAVE_NO_DUPS         # Don't save duplicates to file

# Completion settings - modern and user-friendly
autoload -Uz compinit && compinit
zstyle ':completion:*' matcher-list 'm:{a-zA-Z}={A-Za-z}'  # Case-insensitive completion
zstyle ':completion:*' list-colors ''                      # Colorful completions
zstyle ':completion:*' menu select                         # Menu-driven completion
zstyle ':completion:*' group-name ''                       # Group completions
zstyle ':completion:*' verbose yes                         # Verbose descriptions

# Directory navigation - smart and convenient
setopt AUTO_CD              # Type directory name to cd into it
setopt AUTO_PUSHD           # Automatically push directories to stack
setopt PUSHD_IGNORE_DUPS    # Don't push duplicates to directory stack
setopt CDABLE_VARS          # Allow cd to variables

# Other useful options
setopt CORRECT              # Correct typos in commands
setopt NO_BEEP              # No annoying beeps
setopt INTERACTIVE_COMMENTS # Allow comments in interactive mode

# === ALIASES ===

# Navigation aliases - obvious and efficient
alias ll='ls -lah'          # Long listing with hidden files and human-readable sizes
alias la='ls -A'            # List all files except . and ..
alias l='ls -CF'            # Classify files and columns
alias ..='cd ..'            # Go up one directory
alias ...='cd ../..'        # Go up two directories
alias ....='cd ../../..'    # Go up three directories

# Git shortcuts - essential workflow commands
alias gs='git status'                    # Quick status check
alias gd='git diff'                      # See changes
alias gc='git commit'                    # Commit changes
alias gca='git commit -a'                # Commit all tracked changes
alias gcm='git commit -m'                # Commit with message
alias gp='git push'                      # Push to remote
alias gl='git log --oneline -10'         # Recent commits, concise
alias ga='git add'                       # Add files to staging
alias gaa='git add .'                    # Add all files
alias gb='git branch'                    # List branches
alias gco='git checkout'                 # Switch branches
alias gcb='git checkout -b'              # Create and switch to new branch

# Common commands - productivity boosters
alias grep='grep --color=auto'           # Colorful grep
alias fgrep='fgrep --color=auto'         # Colorful fgrep
alias egrep='egrep --color=auto'         # Colorful egrep
alias mkdir='mkdir -p'                   # Create parent directories
alias df='df -h'                         # Human-readable disk usage
alias du='du -h'                         # Human-readable directory usage
alias free='free -h'                     # Human-readable memory usage (if available)
alias ps='ps aux'                        # Detailed process list
alias reload='source ~/.zshrc'           # Reload zsh configuration

# macOS specific aliases
if [[ "$OSTYPE" == "darwin"* ]]; then
    alias ls='ls -G'                      # Colorful ls on macOS
    alias o='open'                        # Open files/directories
    alias finder='open -a Finder'         # Open Finder
else
    alias ls='ls --color=auto'            # Colorful ls on Linux
fi

# === PROMPT ===

# Starship prompt - modern, fast, and informative
eval "$(starship init zsh)"

# === TOOLS ===

# Python environment management
export PYENV_ROOT="$HOME/.pyenv"
if command -v pyenv >/dev/null; then
    export PATH="$PYENV_ROOT/bin:$PATH"
    eval "$(pyenv init -)"
fi

# Deno JavaScript/TypeScript runtime
if [ -f "/Users/tmd/.deno/env" ]; then
    source "/Users/tmd/.deno/env"
fi

# Local bin environment setup
if [ -f "$HOME/.local/bin/env" ]; then
    source "$HOME/.local/bin/env"
fi

# Project management functions - custom workflow tools
if [ -f "$HOME/.local/bin/project-functions.sh" ]; then
    source "$HOME/.local/bin/project-functions.sh"
fi

# === AI ASSISTANCE (COMMENTED OUT BY DEFAULT) ===
# Uncomment for AI assistance (explicit opt-in)

# GitHub Copilot CLI integration
# eval "$(gh copilot alias -- zsh)"

# GitHub Copilot manual aliases
# alias '??'='gh copilot suggest'
# alias 'git?'='gh copilot suggest --type git'
# alias 'gh?'='gh copilot suggest --type gh'

# === CONDA (COMMENTED OUT) ===
# Conda package manager (commented out - uncomment if needed)
# __conda_setup="$('/opt/miniconda3/bin/conda' 'shell.zsh' 'hook' 2> /dev/null)"
# if [ $? -eq 0 ]; then
#     eval "$__conda_setup"
# else
#     if [ -f "/opt/miniconda3/etc/profile.d/conda.sh" ]; then
#         . "/opt/miniconda3/etc/profile.d/conda.sh"
#     else
#         export PATH="/opt/miniconda3/bin:$PATH"
#     fi
# fi
# unset __conda_setup

# ============================================================================
# End of Configuration
# ============================================================================